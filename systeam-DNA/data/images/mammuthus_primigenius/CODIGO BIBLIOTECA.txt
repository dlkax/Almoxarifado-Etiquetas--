import matplotlib.pyplot as plt

class Livro:
    def __init__(self, titulo, autor, genero):
        self.titulo = titulo
        self.autor = autor
        self.genero = genero
        self.disponivel = True
        
    def __str__(self):
        return f"'{self.titulo}' por {self.autor} - {'Disponível' if self.disponivel else 'Indisponível'}"
    

class Biblioteca:
    def __init__(self):
        self.livros = []
        
    def adicionar_livro(self, livro):
        self.livros.append(livro)
        print(f"Livro '{livro.titulo}' adicionado à biblioteca.")
        
    def listar_livros(self):
        if not self.livros:
            print("Nenhum livro na biblioteca.")
            return
        for livro in self.livros:
            print(livro)
            
    def buscar_livro(self, titulo):
        for livro in self.livros:
            if livro.titulo.lower() == titulo.lower():
                print(livro)
                return livro
        print(f"Livro '{titulo}' não encontrado.")
        return None 
    
    def gerar_grafico_generos(self):
        if not self.livros:
            print("Nenhum livro na biblioteca para gerar gráfico.")
            return

        genero_count = {}
        for livro in self.livros:
            genero_count[livro.genero] = genero_count.get(livro.genero, 0) + 1
                
        generos = list(genero_count.keys())
        counts = list(genero_count.values())
        
        plt.bar(generos, counts)
        plt.xlabel('Gêneros')
        plt.ylabel('Número de Livros')
        plt.title('Distribuição de Gêneros na Biblioteca')
        plt.show()


if __name__ == "__main__":
    biblioteca = Biblioteca()
    
    while True:
        print("\nMenu:")
        print("1. Adicionar livro")
        print("2. Listar livros")
        print("3. Buscar livro")
        print("4. Gerar gráfico de gêneros")
        print("0. Sair")
        
        escolha = input("Escolha uma opção: ")
        
        if escolha == '1':
            titulo = input("Título do livro: ")
            autor = input("Autor do livro: ")
            genero = input("Gênero do livro: ")
            novo_livro = Livro(titulo, autor, genero)
            biblioteca.adicionar_livro(novo_livro)
            
        elif escolha == '2':
            biblioteca.listar_livros()
            
        elif escolha == '3':
            titulo = input("Título do livro a buscar: ")
            biblioteca.buscar_livro(titulo)

        elif escolha == '4':
            biblioteca.gerar_grafico_generos()
            
        elif escolha == '0':
            print("Saindo...")
            break
            
        else:
            print("Opção inválida. Tente novamente.")
